
\section{Introduction}

In the spirit of \citet{burge1975recursive}, this document collects our effort
to make into practice what Burge describes in the first half of Chapter $3$ in
his book -- for your humble author, it is a collection of seminal idea now
available in present functional programming languages, by the way. For this
reason, much of the content has been borrowed from that chapter and extended
using recent outstanding references, such as \citet{sedgewick2014introduction}
and the more ambitious work of \citet{flajolet2009analytic}.

Our contribution is a practical implementation using the Python language of the
abstract ideas introduced by the referenced authors, which aims \emph{to
automate the computation of generating functions (both ordinary and
exponential) for arbitrary compositions of types}; moreover, the interleave of
symbolic manipulation with the usual functional style allows us to obtain
counting formulae in closed form; paraphrasing \citet{Wilf:2006:GEN:1204575}, a
generating function is a clothesline on which we hang up a sequence of
\textit{symbols} for display.

This work is an extended exercise to understand concepts of combinatorial
analysis drawing ideas and inspiration from \citet{riordan2002introduction}
\footnote{Say that additional material from olimpic training and clever uses
are collected too.}, trying to collect them in one place in the while;
eventually, we wish to \textit{use generating functions as a true enumeration
device by a tight integration with symbolic programming}, in addition to their
counting capabilities which, on the contrary, say nothing about the structure
of actual objects being counted.

How to read this document: words in \texttt{monospace font} represent Python
code that can be typed and evaluated in a Python 3 interpreter while the
results of the execution are reported in the lines immediately below formatted
according to their nature, usually using standard \TeX\, math symbols. In the
prose we introduce and describe classes of Python objects that implement the
desired theory, postponing their precise definitions in Section
\ref{sec:appendix}. Moreover, we assume that the bindings
\begin{minted}[baselinestretch=0.8]{python}
x,y,m,n,t,z = symbols('x y m n t z')
alpha, beta, gamma, eta = symbols(r'\alpha \beta \gamma \eta')
f,g = Function('f'), Function('g')
w = IndexedBase('w')
\end{minted}
last till the end of this work and they are in scope for all definitions, finally
the variable $z$ will be reserved for counting with respect to the number of
atomic objects within a combinatorial structure.

\section{Syntax and semantic}

The type system subject of our study is defined by the grammar
\begin{definition}[Syntax]
\begin{displaymath}
\begin{split}
\Gamma\quad::=%\quad&\tyunit\indent\textit{(empty type)} \\
              \quad&\textbf{tyvar}\,\mathcal{V}\indent\textit{(type variable)} \\
             |\quad&\typarens{\Gamma}\indent\textit{(precedence)} \\
             |\quad&\tydu{\Gamma}{\Gamma}\indent\textit{(disjoint union)} \\
             |\quad&\tycp{\Gamma}{\Gamma}\indent\textit{(cartesian product)} \\
             %|\quad&\Gamma\,\times_{b}\,\Gamma\indent\textit{(binomial product)} \\
             |\quad&\tyrec{\mathcal{V}}{\Gamma}\indent\textit{(recursion)} \\
             |\quad&\mathcal{F}(\,\Gamma\,)\indent\textit{(transformation)} \\
             %|\quad&-\,\Gamma\indent\textit{(negation)} \\
             %|\quad&2^{\Gamma}\indent\textit{(set of all finite subsets)} \\
             %|\quad&(-2)^{\Gamma}\indent\textit{(derangements)} \\
             %|\quad&\sim\Gamma\indent\textit{(cycles)} \\
             |\quad&\partial_{\mathcal{V}}\,{\Gamma}\indent\textit{(derivation)} \\
             |\quad&\int_{\mathcal{V}}{\Gamma}\indent\textit{(integration)} \\
             |\quad&\Gamma\big|_{\mathcal{V}=\Gamma}\indent\textit{(substitution)} \\
\end{split}
\end{displaymath}
where $\mathcal{V}=  \lbrace v_{i} \rbrace_{i\in\mathbb{N}}$ is a
\textit{countable} set of pure symbols and we use the overload
$\tyvar{\typarens{\alpha_{0}\cdots\alpha_{k-1}}}$ to denote
$\tycp{\typarens{\tyvar{\alpha_{0}}}}{\tycp{\cdots}{\typarens{\tyvar{\alpha_{k-1}}}}}$
for $k>0$; moreover, $\mathcal{F}$ is a set of continuous and differentiable
    (infinitely many times) functions over $\mathbb{Z}[z]$, namely
    $\mathcal{F} = \lbrace f\,\in\,C^{\infty}(\mathbb{Z}[z],
    \mathbb{Z}[z])\rbrace$.
\end{definition}

In what follow, we stick to the habit that uses greek symbols to denote type
variables. The following conventions are in order: (i)~operators $\cup$ and
$\times$ associate to the right, $(a \cup b \cup c)$ and $(a \times b \times
d)$ denote $\left(a \cup (b \cup c)\right)$ and $(a \times (b \times d))$
respectively, (ii)~the application $a\,b\,c$ associates to the left, namely
$(a\,b)\,c$ as in currified function applications and (iii)~function
application has higher precedence over $\times$ which has higher precedence
over $\cup$, as usual.

We give meaning to the introduced syntax by
\begin{definition}[Semantic]
The semantic function $\semantic{}: \Gamma \rightarrow
\mathbb{Z}[z]$ is defined by structural induction for terms in $\Gamma$,
\begin{displaymath}
\begin{split}
    %\semantic{\tyunit} &= 1 \\
    \semantic{\tyvar{\gamma}} &= \gamma \\
    \semantic{\typarens{\gamma}} &= \semantic{\gamma}\\
    \semantic{\tydu{a}{b}} &= \semantic{a} + \semantic{b} \\
    \semantic{\tycp{a}{b}} &= \semantic{a}\cdot\semantic{b} \\
    %\semantic{a\,\times_{b}\,c} &= \semantic{a}\star\semantic{c} \\
    \semantic{\tyrec{\gamma}{a}} &= \beta  \quad\text{where}\quad
        %\semantic{\textbf{tyvar}\,\gamma}\,=_{\beta}\,\semantic{a\,[\textbf{tyvar}\,\gamma/\gamma]}\\
        \semantic{\tyvar{\gamma}}\,=_{\gamma,\beta}\,\semantic{a}\\
    %\semantic{-\,a} &= -\,\semantic{a}\\
    %\semantic{2^{a}} &= e^{\semantic{a}}\\
    %\semantic{(-2)^{a}} &= \frac{e^{-\beta}}{1-\beta}\quad\text{where}\quad\beta=\semantic{a}(z)\\
    %\semantic{\sim a} &= log\,\semantic{a}\\
    \semantic{f(\,a\,)} &= f(\,\semantic{a}\,)\indent\textit{(recall that $f\,:\,\mathbb{Z}[z]\rightarrow\mathbb{Z}[z]$)}\\
    \semantic{\partial_{z}\,a} &= \frac{\partial}{\partial\,z}\,\semantic{a}\\
    \semantic{\int_{z}{a}} &= \int_{0}^{z}{\semantic{a\big|_{z=\tyvar{\gamma}}}\,d\gamma}\indent\text{where $\gamma$ is fresh wrt $a$}\\
    \semantic{a\big|_{z=b}} &= \semantic{a}\big|_{z=\semantic{b}}\\
\end{split}
\end{displaymath}
denoting with $\alpha\,=_{\gamma,\beta}\,\eta$ that $\beta$ is
the\footnote{Actually, for the types we are interested in we have
\textit{exactly one} generating function but in the general case we might have
more than one solution.} solution of the equation $\alpha\,=\,\eta$ with
respect to $\gamma$ -- observe that $\beta$ might depend on a subset
$A\subset\mathcal{V}$; moreover, the operator $c\,\big|_{a=b}$ substitutes
every occurrence of $a$ expressions with the $b$ expression in the context
expression $c$.
\end{definition}

In plain words, $\semantic{a}$ yields  the \textit{generating function} that
counts the number of atomic objects in values of type $a$; in particular, the
coefficient $a_{n}$ of $z^{n}$ in the series expansion of $\semantic{a}$, in
symbols $[z^{n}]\,\semantic{a} = a_{n}$\footnote{This "operation" should be
added to the language too since it applies to a gf.}, counts the number of
atomic objects within a value of dimension $n$ with type $a\in\Gamma$ -- the
operator $[z^{n}]$ is studied in depth by \citet{MSV07}.

Precisely, the semantic of the cartesian product type
$\tycp{\Gamma}{\Gamma}$ is defined as the Cauchy convolution
\begin{displaymath}
    \semantic{a}\cdot\semantic{b} = \sum_{n\in\mathbb{N}}{\left(\sum_{k=0}^{n}{a_{k}b_{n-k}}\right)\,z^{n}},
\end{displaymath}
to which the binomial product type $\Gamma\,\times_{b}\,\Gamma$ can be reduced by
\begin{displaymath}
\begin{split}
    \semantic{a}\star\semantic{b}
        &= \sum_{n\in\mathbb{N}}{\left(\sum_{k=0}^{n}{{ {n}\choose{k} }a_{k}b_{n-k}}\right)\,\frac{z^{n}}{n!}}
         = \sum_{n\in\mathbb{N}}{\left(\sum_{k=0}^{n}{\frac{a_{k}}{k!}\,\frac{b_{n-k}}{(n-k)!}}\right)\,z^{n}} \\
        &= \semantic{\hat{a}}\cdot\semantic{\hat{b}} \quad\text{where}\quad[t^{n}]\semantic{\hat{c}} = \frac{1}{n!}\,[t^{n}]\semantic{c},
\end{split}
\end{displaymath}
allows us to manipulate both ordinary and exponential generating functions,
enumerating \textit{unlabelled} and \textit{labelled} objects respectively.

The enumeration of a type $a\in\Gamma$ can (i)~be unified and generalized using
their semantic $\semantic{a}$ and can (ii)~be interpreted in terms of boxes and
placements of objects in them; for the sake of clarity, for us \textit{a box is
a configuration of a (possibly infinite) collection of cells} and it can be represented graphically as
\begin{displaymath}
\underbrace{\underbrace{\quad}_{\textit{a cell}}\quad\underbrace{\quad}_{\textit{another cell}}\quad\cdots}_{\textit{a box}}
\end{displaymath}
finally, a \textit{cell holds either an atomic object or another box}. The
connection among a type $a\in\Gamma$ and a box $B$ is that $a$ defines the
configuration of the cells within $B$, namely $\displaystyle
\underbrace{a\in\Gamma}_{\textit{box }\,B}$.  Starting small, the two primitive types
$\tyunit$ and $\tyvar{(\alpha\,z)}$ denotes the boxes $E$ and $O$, graphically depicted as
\begin{displaymath}
\underbrace{\underbrace{1}_{\textit{a cell}}}_{\textit{box E}}\quad\text{and}\quad
\underbrace{\underbrace{\alpha}_{\textit{a cell}}}_{\textit{box O}},
\end{displaymath}
which both indicate a box having one cell that is empty and holds \textit{one}
object of type $\alpha$, respectively.  Therefore, when we write down a type,
we give the configuration of a box, namely types represent selections of
objects to fullfil cells in that box.

\begin{definition}[\tyunit]
The type that has not inhabitants is in order,
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\tyunit}{\tyvar{1}}{empty type}\\
\end{split}
\end{displaymath}
with semantic
\begin{displaymath}
    \semantic{\tyunit} = 1.
\end{displaymath}
\end{definition}

The goal of this language is twofold, (i)~it allows us to describe families of
values and, in parallel, (ii)~to count when a specific object appear in a
combinatorial configuration; in order to have the second one, we introduce the
following syntactic sugar
\begin{definition}
The "subscript" type that count the occurrence of a value of type $a\in\Gamma$
with respect to a symbol $\alpha\in\mathcal{V}$,
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\tycount{\Gamma}{\mathcal{V}}}{\tycp{\Gamma}{\tyvar{\mathcal{V}}}}{counting}\\
\end{split}
\end{displaymath}
with semantic
\begin{displaymath}
    \semantic{\tycount{a}{\alpha}} = \semantic{\tycp{a}{\tyvar{\alpha}}}.
\end{displaymath}
\end{definition}

\section{Linear types}

This section explores how combinations of the primitive types $\tyunit$ and
$\tyvar{\alpha}$ yield new types that allows us to solve some combinatorial and
enumeration problems; as a consequence, they start to put to boxes analogy into
practice. First of all the types for logic reasoning are introduced next.

\begin{definition}[\tytruth, \tyfalsehood, \tyboolean]
Types that represent truth, falsehood and boolean are in order,
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\tytruth}{\tyvar{w_{1}}}{logical success}\\
           |\quad&\tydef{\tyfalsehood}{\tyvar{w_{0}}}{logical failure}\\
           |\quad&\tydef{\tyboolean}{\tydu{\tytruth}{\tyfalsehood}}{logical choice}\\
\end{split}
\end{displaymath}
where $w_{1}, w_{0} \in\mathcal{V}$ with semantic
\begin{displaymath}
\begin{split}
    \semantic{\tytruth} &= w_{1}\\
    \semantic{\tyfalsehood} &= w_{0}\\
    \semantic{\tyboolean} &= w_{1} + w_{0},
\end{split}
\end{displaymath}
respectively.
\end{definition}

The previous definitions shows that symbols $w_{1}$ and $w_{0}$ resemble
\textit{true} and \textit{false} objects, as usual -- observe that no formal
variables that counts according to a measure is used.

\begin{example}
Let $\alpha\in\mathcal{V}$ and consider the type
\begin{displaymath}
    \tydu{\tyunit}{\tycount{\typarens{\tyvar{\alpha}}}{z}}
\end{displaymath}
whose generating function can be found by the semantic
\begin{displaymath}
    \semantic{\tydu{\tyunit}{\tycount{\typarens{\tyvar{\alpha}}}{z}}} = 1 + \alpha\,z
\end{displaymath}
which represents the possibility to choose an element of type \tyvar{\alpha} or
to choose nothing.
\end{example}

Previous examples is only the beginning and the following one connects
the boxes analogy with a problem about powers of natural numbers.

\begin{example}
Enumerate all numbers that can be written as sum of powers of $2$, $3$, $5$ and
$7$ respectively, using at most $4$ powers of each, in that case a single time.
The answer lies in the semantic
\begin{displaymath}
\semantic{\tycp{a}{\tycp{b}{\tycp{c}{d}}}} = \left(z^{b^{0}} {\space}_{b^{0}} + 1\right) \left(z^{b^{1}} {\space}_{b^{1}} + 1\right) \left(z^{b^{2}} {\space}_{b^{2}} + 1\right) \left(z^{b^{3}} {\space}_{b^{3}} + 1\right),
\end{displaymath}
\begin{displaymath}
\begin{split}
\text{where}\quad
    a &= \typarens{\tydu{\tyunit}{\tyvar{{\space}_{b^{0}} z^{b^{0}}}}},\quad
        b = \typarens{\tydu{\tyunit}{\tyvar{{\space}_{b^{1}} z^{b^{1}}}}},\\
    c &= \typarens{\tydu{\tyunit}{\tyvar{{\space}_{b^{2}} z^{b^{2}}}}}\quad\text{and}\quad
        d = \typarens{\tydu{\tyunit}{\tyvar{{\space}_{b^{3}} z^{b^{3}}}}},
\end{split}
\end{displaymath}
and its series expansion with respect to $z$ enumerates (i)~for $b=2$,
\begin{displaymath}
\begin{split}
&z^{15} {\space}_{2^{0}} {\space}_{2^{1}} {\space}_{2^{2}} {\space}_{2^{3}} + z^{14} {\space}_{2^{1}} {\space}_{2^{2}} {\space}_{2^{3}} + z^{13} {\space}_{2^{0}} {\space}_{2^{2}} {\space}_{2^{3}} + z^{12} {\space}_{2^{2}} {\space}_{2^{3}} + z^{11} {\space}_{2^{0}} {\space}_{2^{1}} {\space}_{2^{3}} + z^{10} {\space}_{2^{1}} {\space}_{2^{3}} + z^{9} {\space}_{2^{0}} {\space}_{2^{3}} + \\
&z^{8} {\space}_{2^{3}} + z^{7} {\space}_{2^{0}} {\space}_{2^{1}} {\space}_{2^{2}} + z^{6} {\space}_{2^{1}} {\space}_{2^{2}} + z^{5} {\space}_{2^{0}} {\space}_{2^{2}} + z^{4} {\space}_{2^{2}} + z^{3} {\space}_{2^{0}} {\space}_{2^{1}} + z^{2} {\space}_{2^{1}} + z {\space}_{2^{0}} + 1;
\end{split}
\end{displaymath}
(ii)~for $b=3$,
\begin{displaymath}
\begin{split}
&z^{40} {\space}_{3^{0}} {\space}_{3^{1}} {\space}_{3^{2}} {\space}_{3^{3}} + z^{39} {\space}_{3^{1}} {\space}_{3^{2}} {\space}_{3^{3}} + z^{37} {\space}_{3^{0}} {\space}_{3^{2}} {\space}_{3^{3}} + z^{36} {\space}_{3^{2}} {\space}_{3^{3}} + z^{31} {\space}_{3^{0}} {\space}_{3^{1}} {\space}_{3^{3}} + z^{30} {\space}_{3^{1}} {\space}_{3^{3}} + z^{28} {\space}_{3^{0}} {\space}_{3^{3}} + \\
&z^{27} {\space}_{3^{3}} + z^{13} {\space}_{3^{0}} {\space}_{3^{1}} {\space}_{3^{2}} + z^{12} {\space}_{3^{1}} {\space}_{3^{2}} + z^{10} {\space}_{3^{0}} {\space}_{3^{2}} + z^{9} {\space}_{3^{2}} + z^{4} {\space}_{3^{0}} {\space}_{3^{1}} + z^{3} {\space}_{3^{1}} + z {\space}_{3^{0}} + 1;
\end{split}
\end{displaymath}
(iii)~for $b=5$,
\begin{displaymath}
\begin{split}
&z^{156} {\space}_{5^{0}} {\space}_{5^{1}} {\space}_{5^{2}} {\space}_{5^{3}} + z^{155} {\space}_{5^{1}} {\space}_{5^{2}} {\space}_{5^{3}} + z^{151} {\space}_{5^{0}} {\space}_{5^{2}} {\space}_{5^{3}} + z^{150} {\space}_{5^{2}} {\space}_{5^{3}} + z^{131} {\space}_{5^{0}} {\space}_{5^{1}} {\space}_{5^{3}} + z^{130} {\space}_{5^{1}} {\space}_{5^{3}} + z^{126} {\space}_{5^{0}} {\space}_{5^{3}} + \\
&z^{125} {\space}_{5^{3}} + z^{31} {\space}_{5^{0}} {\space}_{5^{1}} {\space}_{5^{2}} + z^{30} {\space}_{5^{1}} {\space}_{5^{2}} + z^{26} {\space}_{5^{0}} {\space}_{5^{2}} + z^{25} {\space}_{5^{2}} + z^{6} {\space}_{5^{0}} {\space}_{5^{1}} + z^{5} {\space}_{5^{1}} + z {\space}_{5^{0}} + 1
\end{split}
\end{displaymath}
and (iv)~for $b=7$,
\begin{displaymath}
\begin{split}
&z^{400} {\space}_{7^{0}} {\space}_{7^{1}} {\space}_{7^{2}} {\space}_{7^{3}} + z^{399} {\space}_{7^{1}} {\space}_{7^{2}} {\space}_{7^{3}} + z^{393} {\space}_{7^{0}} {\space}_{7^{2}} {\space}_{7^{3}} + z^{392} {\space}_{7^{2}} {\space}_{7^{3}} + z^{351} {\space}_{7^{0}} {\space}_{7^{1}} {\space}_{7^{3}} + z^{350} {\space}_{7^{1}} {\space}_{7^{3}} + z^{344} {\space}_{7^{0}} {\space}_{7^{3}} + \\
&z^{343} {\space}_{7^{3}} + z^{57} {\space}_{7^{0}} {\space}_{7^{1}} {\space}_{7^{2}} + z^{56} {\space}_{7^{1}} {\space}_{7^{2}} + z^{50} {\space}_{7^{0}} {\space}_{7^{2}} + z^{49} {\space}_{7^{2}} + z^{8} {\space}_{7^{0}} {\space}_{7^{1}} + z^{7} {\space}_{7^{1}} + z {\space}_{7^{0}} + 1,
\end{split}
\end{displaymath}
respectively; for the sake of clarity, $z^{393} {\space}_{7^{0}} {\space}_{7^{2}}
{\space}_{7^{3}}$ proves that $393 = 7^{0} + 7^{2} + 7^{3}$.
\end{example}

\begin{definition}[\tymaybe{\gamma}]
The generalization of the previous type is so fundamental that we stick to it a name
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\tymaybe{\Gamma}}{\tydu{\tyvar{␣}}{\Gamma}}{possible occurrence}
\end{split}
\end{displaymath}
with semantic
\begin{displaymath}
    \semantic{\tymaybe{a}} = ␣\,+\,\semantic{a},
\end{displaymath}
namely $\tymaybe{a}$ says that \textit{an object of type $a$
may not or may appear in a box configuration}.
\end{definition}

Using the types seen so far it is possible to tackle some occupancy problems,
as follows in the next examples.

\begin{example}
What's the occupancy configurations of $4$ boxes using $4$ objects
$u_{0}$,$u_{1}$,$u_{2}$ and $u_{3}$, where each object may not or may be
selected for placement?

The answer lies in the semantic
\begin{displaymath}
    \semantic{\tycp{a}{\tycp{b}{\tycp{c}{d}}}} = \left(z u_{0} + ␣\right) \left(z u_{1} + ␣\right) \left(z u_{2} + ␣\right) \left(z u_{3} + ␣\right)
\end{displaymath}
\begin{displaymath}
\begin{split}
\text{where}\quad
a&={\tymaybe{\typarens{\tyvar{u_{0}\,z}}}},\quad b={\tymaybe{\typarens{\tyvar{u_{1}\,z}}}},\\
c&={\tymaybe{\typarens{\tyvar{u_{2}\,z}}}}\quad\text{and}\quad d={\tymaybe{\typarens{\tyvar{u_{3}\,z}}}},
\end{split}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the cases (i)~\textit{unlike objects in unlike boxes}
\begin{displaymath}
\begin{split}
&z^{4} u_{0} u_{1} u_{2} u_{3} +\\
&z^{3} \left(u_{0} u_{1} u_{2} ␣ + u_{0} u_{1} ␣ u_{3} + u_{0} ␣ u_{2} u_{3} + ␣ u_{1} u_{2} u_{3}\right) + \\
&z^{2} \left(u_{0} u_{1} ␣^{2} + u_{0} ␣ u_{2} ␣ + u_{0} ␣^{2} u_{3} + ␣ u_{1} u_{2} ␣ + ␣ u_{1} ␣ u_{3} + ␣^{2} u_{2} u_{3}\right) + \\
&z \left(u_{0} ␣^{3} + ␣ u_{1} ␣^{2} + ␣^{2} u_{2} ␣ + ␣^{3} u_{3}\right) + \\
&␣^{4};
\end{split}
\end{displaymath}
(ii)~\textit{unlike objects in like boxes}
\begin{displaymath}
\begin{split}
&u_{0} u_{1} u_{2} u_{3} z^{4} + \\
&z^{3} \left(u_{0} u_{1} u_{2} ␣ + u_{0} u_{1} u_{3} ␣ + u_{0} u_{2} u_{3} ␣ + u_{1} u_{2} u_{3} ␣\right) + \\
&z^{2} \left(u_{0} u_{1} ␣^{2} + u_{0} u_{2} ␣^{2} + u_{0} u_{3} ␣^{2} + u_{1} u_{2} ␣^{2} + u_{1} u_{3} ␣^{2} + u_{2} u_{3} ␣^{2}\right) + \\
&z \left(u_{0} ␣^{3} + u_{1} ␣^{3} + u_{2} ␣^{3} + u_{3} ␣^{3}\right) +\\
&␣^{4};
\end{split}
\end{displaymath}
(iii)~\textit{like objects in unlike boxes}
\begin{displaymath}
\begin{split}
&z^{4} \bullet^{4} + \\
&z^{3} \left(\bullet ␣ \bullet^{2} + \bullet^{2} ␣ \bullet + \bullet^{3} ␣ + ␣ \bullet^{3}\right) + \\
&z^{2} \left(\bullet ␣ \bullet ␣ + \bullet ␣^{2} \bullet + \bullet^{2} ␣^{2} + ␣ \bullet ␣ \bullet + ␣ \bullet^{2} ␣ + ␣^{2} \bullet^{2}\right) + \\
&z \left(\bullet ␣^{3} + ␣ \bullet ␣^{2} + ␣^{2} \bullet ␣ + ␣^{3} \bullet\right) +\\
&␣^{4}
\end{split}
\end{displaymath}
and (iv)~\textit{like objects in like boxes}
\begin{displaymath}
\circ^{4} z^{4} + 4 \circ^{3} z^{3} + 6 \circ^{2} z^{2} + 4 \circ z + 1
\end{displaymath}
respectively.
\end{example}

Previous example shows that each coefficient of $z^{i}$ in series expansions
denotes configurations using a summation, in particular each summand indicates
which object goes in which box; it was pretty symmetric, therefore the next
uses a different objects setting, though similar in the spirit.

\begin{example}
What's the occupancy configurations of $3$ boxes using $3$ objects
$o_{0}$,$o_{1}$ and $o_{2}$, where the first object may not or may be selected
for placement, the second may not or may be selected either one or two times
    and the third may not or may be selected either one or two or three times?

The answer lies in the semantic
\begin{displaymath}
    \semantic{\tycp{a}{\tycp{b}{c}}} = \left(z u_{0} + ␣\right) \left(z^{2} u_{1}^{2} + z u_{1} + ␣\right) \left(z^{3} u_{2}^{3} + z^{2} u_{2}^{2} + z u_{2} + ␣\right)
\end{displaymath}
\begin{displaymath}
\begin{split}
\text{where}&\quad
a={\tymaybe{\typarens{\tyvar{u_{0}\,z}}}}, b={\tymaybe{\typarens{\tydu{\tyvar{u_{1}\,z}}{\tyvar{u_{1}^{2}\,z^{2}}}}}}\\
\quad&\text{and}\quad d={\tymaybe{\typarens{\tydu{\tyvar{u_{3}\,z}}{\tydu{\tyvar{u_{3}^{2}\,z^{2}}}{\tyvar{u_{3}^{3}\,z^{3}}}}}}},
\end{split}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the cases (i)~\textit{unlike objects in unlike boxes}
\begin{displaymath}
\begin{split}
&z^{6} u_{0} u_{1}^{2} u_{2}^{3} + \\
&z^{5} \left(u_{0} u_{1} u_{2}^{3} + u_{0} u_{1}^{2} u_{2}^{2} + ␣ u_{1}^{2} u_{2}^{3}\right) + \\
&z^{4} \left(u_{0} u_{1} u_{2}^{2} + u_{0} u_{1}^{2} u_{2} + u_{0} ␣ u_{2}^{3} + ␣ u_{1} u_{2}^{3} + ␣ u_{1}^{2} u_{2}^{2}\right) + \\
&z^{3} \left(u_{0} u_{1} u_{2} + u_{0} u_{1}^{2} ␣ + u_{0} ␣ u_{2}^{2} + ␣ u_{1} u_{2}^{2} + ␣ u_{1}^{2} u_{2} + ␣^{2} u_{2}^{3}\right) + \\
&z^{2} \left(u_{0} u_{1} ␣ + u_{0} ␣ u_{2} + ␣ u_{1} u_{2} + ␣ u_{1}^{2} ␣ + ␣^{2} u_{2}^{2}\right) + \\
&z \left(u_{0} ␣^{2} + ␣ u_{1} ␣ + ␣^{2} u_{2}\right) + \\
&␣^{3}
\end{split}
\end{displaymath}
(ii)~\textit{unlike objects in like boxes}
\begin{displaymath}
\begin{split}
&u_{0} u_{1}^{2} u_{2}^{3} z^{6} + \\
&z^{5} \left(u_{0} u_{1}^{2} u_{2}^{2} + u_{0} u_{1} u_{2}^{3} + u_{1}^{2} u_{2}^{3} ␣\right) + \\
&z^{4} \left(u_{0} u_{1}^{2} u_{2} + u_{0} u_{1} u_{2}^{2} + u_{0} u_{2}^{3} ␣ + u_{1}^{2} u_{2}^{2} ␣ + u_{1} u_{2}^{3} ␣\right) + \\
&z^{3} \left(u_{0} u_{1}^{2} ␣ + u_{0} u_{1} u_{2} + u_{0} u_{2}^{2} ␣ + u_{1}^{2} u_{2} ␣ + u_{1} u_{2}^{2} ␣ + u_{2}^{3} ␣^{2}\right) + \\
&z^{2} \left(u_{0} u_{1} ␣ + u_{0} u_{2} ␣ + u_{1}^{2} ␣^{2} + u_{1} u_{2} ␣ + u_{2}^{2} ␣^{2}\right) + \\
&z \left(u_{0} ␣^{2} + u_{1} ␣^{2} + u_{2} ␣^{2}\right) + \\
&␣^{3}
\end{split}
\end{displaymath}
(iii)~\textit{like objects in unlike boxes}
\begin{displaymath}
\begin{split}
&z^{6} \bullet^{6} + \\
&z^{5} \left(2 \bullet^{5} + ␣ \bullet^{5}\right) + \\
&z^{4} \left(\bullet ␣ \bullet^{3} + 2 \bullet^{4} + 2 ␣ \bullet^{4}\right) + \\
&z^{3} \left(\bullet ␣ \bullet^{2} + \bullet^{3} + \bullet^{3} ␣ + 2 ␣ \bullet^{3} + ␣^{2} \bullet^{3}\right) + \\
&z^{2} \left(\bullet ␣ \bullet + \bullet^{2} ␣ + ␣ \bullet^{2} + ␣ \bullet^{2} ␣ + ␣^{2} \bullet^{2}\right) + \\
&z \left(\bullet ␣^{2} + ␣ \bullet ␣ + ␣^{2} \bullet\right) + \\
&␣^{3}
\end{split}
\end{displaymath}
and (iv)~\textit{like objects in like boxes}
\begin{displaymath}
\circ^{6} z^{6} + 3 \circ^{5} z^{5} + 5 \circ^{4} z^{4} + 6 \circ^{3} z^{3} + 5 \circ^{2} z^{2} + 3 \circ z + 1
\end{displaymath}
respectively.
\end{example}

\section{Recursive types}

Last section introduces and deepen linear types and their connection with a
setting of a finite number of boxes; on the other hand, this section studies
how such setting can be extended to consider \textit{countably many} boxes and
their configurations.

\begin{example}
Let $L,\alpha\in\mathcal{V}$ be pure symbols then consider the type
\begin{displaymath}
    \tyrec{L}{\tydu{\tyunit}{\tycp{\tycountp{\tyvar{\alpha}}{z}}{\tyvar{L}}}}
\end{displaymath}
whose generating function can be found by the semantic
\begin{displaymath}
    \semantic{\tyrec{L}{\tydu{\tyunit}{\tycp{\tycountp{\tyvar{\alpha}}{z}}{\tyvar{L}}}}} = \beta
\end{displaymath}
where $\beta$ is the solution of the equation
\begin{displaymath}
    \semantic{\tyvar{L}} = \semantic{\tydu{\tyunit}{\tycp{\tyvar{\alpha\,z}}{\tyvar{L}}}}
\end{displaymath}
which reduces to solve $L = 1 + \alpha\,z\,L$ with respect to $L$, therefore
$\displaystyle L = \frac{1}{1 - \alpha\,z}$ so take $\displaystyle \beta =
\frac{1}{1 - \alpha\,z}$, as required; moreover, its series expansion with
respect to $z$ yields
\begin{displaymath}
1 + \alpha z + \alpha^{2} z^{2} + \alpha^{3} z^{3} + \alpha^{4} z^{4} + \alpha^{5} z^{5} + \alpha^{6} z^{6} + \alpha^{7} z^{7} + \alpha^{8} z^{8} + \alpha^{9} z^{9} + O\left(z^{10}\right)
\end{displaymath}
hence
$[z^{n}]\,\semantic{\tyrec{L}{\tydu{\tyunit}{\tycp{\tycountp{\tyvar{\alpha}}{z}}{\tyvar{L}}}}}
= \alpha^{n}$ which says that there is $1$ composition of $n$ values having
type $\tyvar{\alpha\,z}$ each one of them.
\end{example}

\begin{definition}
The generalization of the previous type is so fundamental that we stick to it a name
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\tylst{\Gamma}}{\tyrec{ \lbrace L \rbrace}{\tydu{\tyunit}{\tycp{\Gamma}{\tyvar{ \lbrace L \rbrace}}}}}{list}
\end{split}
\end{displaymath}
where $L\in\mathcal{V}$ is a fresh symbol not used in $\Gamma$ yet, with semantic
\begin{displaymath}
    \semantic{\tylst{a}} = \frac{1}{1\,-\,\semantic{a}},
\end{displaymath}
namely $\tylst{\gamma}$ is the set of all (possibly infinite) lists of
objects with type $\gamma\in\Gamma$.
\end{definition}

The following three examples shows how simple combinations of types
$\tylst{}$, $\tymaybe{}$ and $\tyboolean$ yield well known combinatorial results.

\begin{example}
Consider the semantic
\begin{displaymath}
    \semantic{\tylst{\tycountp{\tymaybe{\tytruth}}{z}}} = - \frac{1}{w_{1} z + z ␣ - 1}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the cases (i)~\textit{unlike objects in unlike boxes}
\begin{displaymath}
\begin{split}
&1 + \\
&z \left(w_{1} + ␣\right) + \\
&z^{2} \left(w_{1} ␣ + w_{1}^{2} + ␣ w_{1} + ␣^{2}\right) + \\
&z^{3} \left(w_{1} ␣ w_{1} + w_{1} ␣^{2} + w_{1}^{2} ␣ + w_{1}^{3} + ␣ w_{1} ␣ + ␣ w_{1}^{2} + ␣^{2} w_{1} + ␣^{3}\right) + \\
&z^{4} \left(w_{1} ␣ w_{1} ␣ + w_{1} ␣ w_{1}^{2} + w_{1} ␣^{2} w_{1} + w_{1} ␣^{3} + w_{1}^{2} ␣ w_{1} + w_{1}^{2} ␣^{2} + w_{1}^{3} ␣ + w_{1}^{4} \right.+\\
&\indent\left. ␣ w_{1} ␣ w_{1} + ␣ w_{1} ␣^{2} + ␣ w_{1}^{2} ␣ + ␣ w_{1}^{3} + ␣^{2} w_{1} ␣ + ␣^{2} w_{1}^{2} + ␣^{3} w_{1} + ␣^{4}\right) + O\left(z^{5}\right);
\end{split}
\end{displaymath}
(ii)~\textit{unlike objects in like boxes}
\begin{displaymath}
\begin{split}
&1 + \\
&z \left(w_{1} + ␣\right) + \\
&z^{2} \left(w_{1}^{2} + 2 w_{1} ␣ + ␣^{2}\right) + \\
&z^{3} \left(w_{1}^{3} + 3 w_{1}^{2} ␣ + 3 w_{1} ␣^{2} + ␣^{3}\right) + \\
&z^{4} \left(w_{1}^{4} + 4 w_{1}^{3} ␣ + 6 w_{1}^{2} ␣^{2} + 4 w_{1} ␣^{3} + ␣^{4}\right) + O\left(z^{5}\right);
\end{split}
\end{displaymath}
in parallel, the enumerations for \textit{like objects in unlike boxes}
equals the previous one with the substitutions $w_{1}\mapsto\bullet$;
finally, (iii)~\textit{like objects in like boxes}
\begin{displaymath}
\begin{split}
&1 +\\
&z \left(\circ + 1\right) + \\
&z^{2} \left(\circ^{2} + 2 \circ + 1\right) + \\
&z^{3} \left(\circ^{3} + 3 \circ^{2} + 3 \circ + 1\right) + \\
&z^{4} \left(\circ^{4} + 4 \circ^{3} + 6 \circ^{2} + 4 \circ + 1\right) + O\left(z^{5}\right),
\end{split}
\end{displaymath}
respectively.
\end{example}

\begin{example}
Consider the following semantic
\begin{displaymath}
    \semantic{\tycp{\typarens{\tylst{\tycount{\tytruth}{z}}}}{\typarens{\tylst{\tycount{\tyfalsehood}{z}}}}} =
        \frac{1}{\left(w_{0} z - 1\right) \left(w_{1} z - 1\right)}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the cases (i)~\textit{unlike objects in both unlike and like boxes}
\begin{displaymath}
\begin{split}
&1 + \\
&z \left(w_{0} + w_{1}\right) + \\
&z^{2} \left(w_{0}^{2} + w_{1} w_{0} + w_{1}^{2}\right) + \\
&z^{3} \left(w_{0}^{3} + w_{1} w_{0}^{2} + w_{1}^{2} w_{0} + w_{1}^{3}\right) + \\
&z^{4} \left(w_{0}^{4} + w_{1} w_{0}^{3} + w_{1}^{2} w_{0}^{2} + w_{1}^{3} w_{0} + w_{1}^{4}\right) + \\
&z^{5} \left(w_{0}^{5} + w_{1} w_{0}^{4} + w_{1}^{2} w_{0}^{3} + w_{1}^{3} w_{0}^{2} + w_{1}^{4} w_{0} + w_{1}^{5}\right) + \\
&z^{6} \left(w_{0}^{6} + w_{1} w_{0}^{5} + w_{1}^{2} w_{0}^{4} + w_{1}^{3} w_{0}^{3} + w_{1}^{4} w_{0}^{2} + w_{1}^{5} w_{0} + w_{1}^{6}\right) + O\left(z^{7}\right)
\end{split}
\end{displaymath}
and (ii)~\textit{like objects in both unlike and like boxes}
\begin{displaymath}
1 + 2 z \bullet + 3 z^{2} \bullet^{2} + 4 z^{3} \bullet^{3} + 5 z^{4} \bullet^{4} + 6 z^{5} \bullet^{5} + 7 z^{6} \bullet^{6} + O\left(z^{7}\right),
\end{displaymath}
respectively; precisely, here the nature of boxes doesn't yield a different
enumeration because there is no $␣$ symbols in the type.
\end{example}

\begin{definition}
The generalization of the previous type is so fundamental that we stick to it a name
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\typosnat}{\tycp{\typarens{\tylst{\tytruth}}}{\typarens{\tylst{\tyfalsehood}}}}{naturals}
\end{split}
\end{displaymath}
with semantic
\begin{displaymath}
    \semantic{\typosnat} =  \frac{1}{\left(w_{0} z - 1\right) \left(w_{1} z - 1\right)}.
\end{displaymath}
\end{definition}

\begin{example}
Consider the semantic
\begin{displaymath}
    \semantic{\tylst{\tycount{\tyboolean}{z}}} = - \frac{1}{w_{0} z + w_{1} z - 1}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the cases (i)~\textit{unlike objects in unlike boxes}
\begin{displaymath}
\begin{split}
&1 + \\
&z \left(w_{0} + w_{1}\right) + \\
&z^{2} \left(w_{0} w_{1} + w_{0}^{2} + w_{1} w_{0} + w_{1}^{2}\right) + \\
&z^{3} \left(w_{0} w_{1} w_{0} + w_{0} w_{1}^{2} + w_{0}^{2} w_{1} + w_{0}^{3} + w_{1} w_{0} w_{1} + w_{1} w_{0}^{2} + w_{1}^{2} w_{0} + w_{1}^{3}\right) + \\
&z^{4} \left(w_{0} w_{1} w_{0} w_{1} + w_{0} w_{1} w_{0}^{2} + w_{0} w_{1}^{2} w_{0} + w_{0} w_{1}^{3} + w_{0}^{2} w_{1} w_{0} + w_{0}^{2} w_{1}^{2} + w_{0}^{3} w_{1} +\right.\\
&\indent\left.w_{0}^{4} + w_{1} w_{0} w_{1} w_{0} + w_{1} w_{0} w_{1}^{2} + w_{1} w_{0}^{2} w_{1} + w_{1} w_{0}^{3} + w_{1}^{2} w_{0} w_{1} + w_{1}^{2} w_{0}^{2} + \right.\\
&\indent\left.w_{1}^{3} w_{0} + w_{1}^{4}\right) + O\left(z^{5}\right)
\end{split}
\end{displaymath}
(ii)~\textit{unlike objects in like boxes}
\begin{displaymath}
\begin{split}
&1 + \\
&z \left(w_{0} + w_{1}\right) + \\
&z^{2} \left(w_{0}^{2} + 2 w_{0} w_{1} + w_{1}^{2}\right) + \\
&z^{3} \left(w_{0}^{3} + 3 w_{0}^{2} w_{1} + 3 w_{0} w_{1}^{2} + w_{1}^{3}\right) + \\
&z^{4} \left(w_{0}^{4} + 4 w_{0}^{3} w_{1} + 6 w_{0}^{2} w_{1}^{2} + 4 w_{0} w_{1}^{3} + w_{1}^{4}\right) + O\left(z^{5}\right)
\end{split}
\end{displaymath}
finally, (iii)~\textit{like objects in both like and unlike boxes}
\begin{displaymath}
\begin{split}
1 + 2 \circ z + 4 \circ^{2} z^{2} + 8 \circ^{3} z^{3} + 16 \circ^{4} z^{4} + O\left(z^{5}\right)
\end{split}
\end{displaymath}
respectively.
\end{example}

\begin{example}
Consider the semantic
\begin{displaymath}
\begin{split}
&\semantic{\tycp{\typarens{\tylst{\tyvar{u_{1}\,z}}}}{
            \tycp{\typarens{\tylst{\tyvar{u_{5}\,z^{5}}}}}{
            \tycp{\typarens{\tylst{\tyvar{u_{10}\,z^{10}}}}}{\right.\\
            &\indent\left.\tycp{\typarens{\tylst{\tyvar{u_{25}\,z^{25}}}}}
                  {\typarens{\tylst{\tyvar{u_{50}\,z^{50}}}}}}}}} \\
\end{split}
\end{displaymath}
which equals
\begin{displaymath}
- \frac{1}{\left(u_{1} z - 1\right) \left(u_{10} z^{10} - 1\right) \left(u_{25} z^{25} - 1\right) \left(u_{5} z^{5} - 1\right) \left(u_{50} z^{50} - 1\right)}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the case of \textit{unlike objects in like boxes}, to change $42¢$
we need to extract the coefficient of $z^{42}$, which is
\begin{displaymath}
\begin{split}
&u_{1}^{42} + u_{1}^{37} u_{5} + u_{1}^{32} u_{10} + u_{1}^{32} u_{5}^{2} + u_{1}^{27} u_{10} u_{5} + u_{1}^{27} u_{5}^{3} + u_{1}^{22} u_{10}^{2} + u_{1}^{22} u_{10} u_{5}^{2} + \\
&u_{1}^{22} u_{5}^{4} + u_{1}^{17} u_{10}^{2} u_{5} + u_{1}^{17} u_{10} u_{5}^{3} + u_{1}^{17} u_{25} + u_{1}^{17} u_{5}^{5} + u_{1}^{12} u_{10}^{3} + u_{1}^{12} u_{10}^{2} u_{5}^{2} + \\
&u_{1}^{12} u_{10} u_{5}^{4} + u_{1}^{12} u_{25} u_{5} + u_{1}^{12} u_{5}^{6} + u_{1}^{7} u_{10}^{3} u_{5} + u_{1}^{7} u_{10}^{2} u_{5}^{3} + u_{1}^{7} u_{10} u_{25} + u_{1}^{7} u_{10} u_{5}^{5} + \\
&u_{1}^{7} u_{25} u_{5}^{2} + u_{1}^{7} u_{5}^{7} + u_{1}^{2} u_{10}^{4} + u_{1}^{2} u_{10}^{3} u_{5}^{2} + u_{1}^{2} u_{10}^{2} u_{5}^{4} + u_{1}^{2} u_{10} u_{25} u_{5} + u_{1}^{2} u_{10} u_{5}^{6} + \\
&u_{1}^{2} u_{25} u_{5}^{3} + u_{1}^{2} u_{5}^{8}
\end{split}
\end{displaymath}
namely, the summand $u_{1}^{12} u_{25} u_{5}$ proves that $42¢$ can be changed
using $12$ $1¢$-coins, $1$ $25¢$-coin and $1$ $5¢$-coin, respectively.
Moreover, $1\$$ can be changed in $292$ ways by substituting $u_{1} = u_{5} =
u_{10} = u_{25} = u_{50} = 1$ in the coefficient of $z^{100}$, which is too
large to be shown here otherwise.
\end{example}


\begin{example}
Enumerate all numbers that can be written as sum of powers of $2$, $3$ and $5$
respectively, using at most $4$ powers of each, in any case using infinitely
many times each power.  The answer lies in the semantic
\begin{displaymath}
\semantic{\tycp{a}{\tycp{b}{\tycp{c}{d}}}} = \frac{1}{\left(z^{b^{0}} \circ_{b^{0}} - 1\right) \left(z^{b^{1}} \circ_{b^{1}} - 1\right) \left(z^{b^{2}} \circ_{b^{2}} - 1\right) \left(z^{b^{3}} \circ_{b^{3}} - 1\right)}
\end{displaymath}
\begin{displaymath}
\begin{split}
\text{where}\quad
    a &= \tylst{\typarens{\tyvar{{\circ}_{b^{0}} z^{b^{0}}}}},\quad
        b = \tylst{\typarens{\tyvar{{\circ}_{b^{1}} z^{b^{1}}}}},\\
    c &= \tylst{\typarens{\tyvar{{\circ}_{b^{2}} z^{b^{2}}}}}\quad\text{and}\quad
        d = \tylst{\typarens{\tyvar{{\circ}_{b^{3}} z^{b^{3}}}}},
\end{split}
\end{displaymath}
and its series expansion with respect to $z$ enumerates (i)~for $b=2$,
\begin{displaymath}
\begin{split}
&1 + z \circ_{1} + z^{2} \left(\circ_{1}^{2} + \circ_{2}\right) + z^{3} \left(\circ_{1}^{3} + \circ_{1} \circ_{2}\right) + z^{4} \left(\circ_{1}^{4} + \circ_{1}^{2} \circ_{2} + \circ_{2}^{2} + \circ_{4}\right) + \\
&z^{5} \left(\circ_{1}^{5} + \circ_{1}^{3} \circ_{2} + \circ_{1} \circ_{2}^{2} + \circ_{1} \circ_{4}\right) + z^{6} \left(\circ_{1}^{6} + \circ_{1}^{4} \circ_{2} + \circ_{1}^{2} \circ_{2}^{2} + \circ_{1}^{2} \circ_{4} + \circ_{2}^{3} + \circ_{2} \circ_{4}\right) + \\
&z^{7} \left(\circ_{1}^{7} + \circ_{1}^{5} \circ_{2} + \circ_{1}^{3} \circ_{2}^{2} + \circ_{1}^{3} \circ_{4} + \circ_{1} \circ_{2}^{3} + \circ_{1} \circ_{2} \circ_{4}\right) + O\left(z^{8}\right)
\end{split}
\end{displaymath}
(ii)~for $b=3$,
\begin{displaymath}
\begin{split}
&1 + z {\circ}_{1} + z^{2} {\circ}_{1}^{2} + z^{3} \left({\circ}_{1}^{3} + {\circ}_{3}\right) + z^{4} \left({\circ}_{1}^{4} + {\circ}_{1} {\circ}_{3}\right) + z^{5} \left({\circ}_{1}^{5} + {\circ}_{1}^{2} {\circ}_{3}\right) +\\
&z^{6} \left({\circ}_{1}^{6} + {\circ}_{1}^{3} {\circ}_{3} + {\circ}_{3}^{2}\right) + z^{7} \left({\circ}_{1}^{7} + {\circ}_{1}^{4} {\circ}_{3} + {\circ}_{1} {\circ}_{3}^{2}\right) + z^{8} \left({\circ}_{1}^{8} + {\circ}_{1}^{5} {\circ}_{3} + {\circ}_{1}^{2} {\circ}_{3}^{2}\right) + O\left(z^{9}\right)
\end{split}
\end{displaymath}
and (iii)~for $b=5$,
\begin{displaymath}
\begin{split}
&1 + z {\circ}_{1} + z^{2} {\circ}_{1}^{2} + z^{3} {\circ}_{1}^{3} + z^{4} {\circ}_{1}^{4} + z^{5} \left({\circ}_{1}^{5} + {\circ}_{5}\right) + z^{6} \left({\circ}_{1}^{6} + {\circ}_{1} {\circ}_{5}\right) +\\
&z^{7} \left({\circ}_{1}^{7} + {\circ}_{1}^{2} {\circ}_{5}\right) + z^{8} \left({\circ}_{1}^{8} + {\circ}_{1}^{3} {\circ}_{5}\right) + z^{9} \left({\circ}_{1}^{9} + {\circ}_{1}^{4} {\circ}_{5}\right) + O\left(z^{10}\right)
\end{split}
\end{displaymath}
respectively; for the sake of clarity, $z^{9} \left({\circ}_{1}^{9} +
{\circ}_{1}^{4} {\circ}_{5}\right)$ proves that both $9 = 9\cdot1$ and $9 =
4\cdot1 + 5$, using only powers of $5$.
\end{example}

\begin{definition}
The generalization of the previous type is so fundamental that we stick to it a name
\begin{displaymath}
\begin{split}
    \Gamma\quad::=\quad&... \\
           |\quad&\tydef{\tynnlst{\Gamma}}{\tyrec{ \lbrace L \rbrace}{\tydu{\Gamma}{\tycp{\Gamma}{\tyvar{ \lbrace L \rbrace}}}}}{non-empty list}
\end{split}
\end{displaymath}
where $L\in\mathcal{V}$ is a fresh symbol not used in $\Gamma$ yet, with semantic
\begin{displaymath}
    \semantic{\tynnlst{a}} = \frac{\semantic{a}}{1\,-\,\semantic{a}},
\end{displaymath}
namely $\tynnlst{\gamma}$ is the set of all (possibly infinite) lists with at least
one object with type $\gamma\in\Gamma$.
\end{definition}

\begin{example}
Consider the semantic
\begin{displaymath}
    \semantic{\tynnlst{\typarens{\tycp{\typarens{\tynnlst{\tycount{\tytruth}{z}}}}{\tyfalsehood}}}} = - \frac{w_{0} w_{1} z}{w_{0} w_{1} z + w_{1} z - 1}
\end{displaymath}
and its series expansion with respect to $z$ enumerates as follows,
according to the cases (i)~\textit{unlike objects in unlike boxes}
\begin{displaymath}
\begin{split}
&z w_{1} w_{0} + \\
&z^{2} \left(w_{1} w_{0} w_{1} + w_{1} w_{0} w_{1} w_{0}\right) + \\
&z^{3} \left(w_{1} w_{0} w_{1} w_{0} w_{1} + w_{1} w_{0} w_{1} w_{0} w_{1} w_{0} + w_{1} w_{0} w_{1}^{2} + w_{1} w_{0} w_{1}^{2} w_{0}\right) + \\
&z^{4} \left(w_{1} w_{0} w_{1} w_{0} w_{1} w_{0} w_{1} + w_{1} w_{0} w_{1} w_{0} w_{1} w_{0} w_{1} w_{0} + w_{1} w_{0} w_{1} w_{0} w_{1}^{2} +\right.\\
&\indent\left. w_{1} w_{0} w_{1} w_{0} w_{1}^{2} w_{0} + w_{1} w_{0} w_{1}^{2} w_{0} w_{1} + w_{1} w_{0} w_{1}^{2} w_{0} w_{1} w_{0} + w_{1} w_{0} w_{1}^{3} + \right.\\
&\indent\left.w_{1} w_{0} w_{1}^{3} w_{0}\right) + O\left(z^{5}\right)
\end{split}
\end{displaymath}
for the sake of clarity, the coefficient of $z^{3}$ might be rewritten as
    $$\left((w_{1} w_{0})^{2} w_{1} + (w_{1} w_{0})^{3} + (w_{1} w_{0})
    w_{1}^{2} + (w_{1} w_{0}) w_{1} (w_{1} w_{0})\right)$$ and should be read
    exponent by exponent to yield the compositions of $3$
    which are $2+1, 3, 1+2$ and $1+1+1$, respectively;
(ii)~\textit{unlike objects in like boxes}
\begin{displaymath}
\begin{split}
&w_{0} w_{1} z +\\
&z^{2} \left(w_{0}^{2} w_{1}^{2} + w_{0} w_{1}^{2}\right) + \\
&z^{3} \left(w_{0}^{3} w_{1}^{3} + 2 w_{0}^{2} w_{1}^{3} + w_{0} w_{1}^{3}\right) + \\
&z^{4} \left(w_{0}^{4} w_{1}^{4} + 3 w_{0}^{3} w_{1}^{4} + 3 w_{0}^{2} w_{1}^{4} + w_{0} w_{1}^{4}\right) + O\left(z^{5}\right)
\end{split}
\end{displaymath}
respectively.
\end{example}

\section{Unlabelled structures}

\begin{minted}[baselinestretch=0.8]{python}
tyvar(x).gf()
\end{minted}
\begin{displaymath}
\left [ \mathcal{V}{\left (x \right )} = x\right ]
\end{displaymath}

\section{Labelled structures}

Before proceeding on our main track we recap some \emph{exponential} generating
functions and their series expansions, for the sake of clarity

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), z**3,ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = z^{3} = 6 z^{3};
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), exp(z),ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = e^{z} = 1 + z + z^{2} + z^{3} + z^{4} + z^{5} + z^{6} + z^{7} + z^{8} + z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), z*exp(z), ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = z e^{z} = z + 2 z^{2} + 3 z^{3} + 4 z^{4} + 5 z^{5} + 6 z^{6} + 7 z^{7} + 8 z^{8} + 9 z^{9} + O\left(z^{10}\right)
\end{displaymath}
which is the exponential dual of the ordinary expansion
\begin{minted}[baselinestretch=0.8]{python}
define(f(z), z*(1/(1-z))*(1/(1-z)),
       ctor=FEq).series(z,n=10,is_exp=False)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{z}{\left(- z + 1\right)^{2}} = z + 2 z^{2} + 3 z^{3} + 4 z^{4} + 5 z^{5} + 6 z^{6} + 7 z^{7} + 8 z^{8} + 9 z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), z**2*exp(z)/factorial(2,evaluate=False),
       ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{z^{2} e^{z}}{2!} = z^{2} + 3 z^{3} + 6 z^{4} + 10 z^{5} + 15 z^{6} + 21 z^{7} + 28 z^{8} + 36 z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), z**3*exp(z)/factorial(3, evaluate=False),
       ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{z^{3} e^{z}}{3!} = z^{3} + 4 z^{4} + 10 z^{5} + 20 z^{6} + 35 z^{7} + 56 z^{8} + 84 z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), (exp(z)+exp(-z))/2,
       ctor=FEq).series(z, n=20, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{e^{z}}{2} + \frac{e^{- z}}{2} = 1 + z^{2} + z^{4} + z^{6} + z^{8} + z^{10} + z^{12} + z^{14} + z^{16} + z^{18} + O\left(z^{20}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), exp(m*z), ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = e^{m z} = 1 + m z + m^{2} z^{2} + m^{3} z^{3} + m^{4} z^{4} + m^{5} z^{5} + m^{6} z^{6} + m^{7} z^{7} + m^{8} z^{8} + m^{9} z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), (exp(z)-1)/z, ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{e^{z} - 1}{z} = 1 + \frac{z}{2} + \frac{z^{2}}{3} + \frac{z^{3}}{4} + \frac{z^{4}}{5} + \frac{z^{5}}{6} + \frac{z^{6}}{7} + \frac{z^{7}}{8} + \frac{z^{8}}{9} + \frac{z^{9}}{10} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), 1/(1-z), ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{1}{- z + 1} = 1 + z + 2 z^{2} + 6 z^{3} + 24 z^{4} + 120 z^{5} + 720 z^{6} + 5040 z^{7} + 40320 z^{8} + 362880 z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), (1/(1-z))*(1/(1-z)), ctor=FEq).series(z, n=10,is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = \frac{1}{\left(- z + 1\right)^{2}} = 1 + 2 z + 6 z^{2} + 24 z^{3} + 120 z^{4} + 720 z^{5} + 5040 z^{6} + 40320 z^{7} + 362880 z^{8} + 3628800 z^{9} + O\left(z^{10}\right);
\end{displaymath}

\begin{minted}[baselinestretch=0.8]{python}
define(f(z), exp(z)**2, ctor=FEq).series(z, n=10, is_exp=True)
\end{minted}
\begin{displaymath}
f{\left (z \right )} = e^{2 z} = 1 + 2 z + 4 z^{2} + 8 z^{3} + 16 z^{4} + 32 z^{5} + 64 z^{6} + 128 z^{7} + 256 z^{8} + 512 z^{9} + O\left(z^{10}\right).
\end{displaymath}

\input{appendix.tex}
